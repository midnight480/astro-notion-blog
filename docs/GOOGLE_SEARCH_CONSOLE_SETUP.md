# Google Search Console 監視設定ガイド

## 概要

SEO Canonical URL & Redirect機能の効果を測定し、重複コンテンツ問題の解決状況を監視するためのGoogle Search Console設定ガイドです。

## 初期設定

### 1. プロパティの追加

#### カスタムドメインの追加
1. [Google Search Console](https://search.google.com/search-console/) にアクセス
2. 「プロパティを追加」をクリック
3. 「URLプレフィックス」を選択
4. `https://midnight480.com` を入力
5. 所有権の確認を実行

#### Cloudflareドメインの追加（監視用）
1. 同様に `https://astro-notion-blog-cq9.pages.dev` も追加
2. 両ドメインの状況を比較監視するため

### 2. 所有権の確認

#### HTMLファイルによる確認（推奨）
1. Google Search ConsoleからダウンロードしたHTMLファイルを `public/` ディレクトリに配置
2. `https://midnight480.com/google[ランダム文字列].html` でアクセス可能にする
3. 「確認」ボタンをクリック

#### HTMLタグによる確認
```html
<!-- Layout.astroの<head>内に追加 -->
<meta name="google-site-verification" content="[確認コード]" />
```

## 監視すべき指標

### 1. URL検査ツール

#### カスタムドメインの確認
- **URL**: `https://midnight480.com/`
- **確認項目**:
  - ✅ インデックス登録済み
  - ✅ Canonical URL: `https://midnight480.com/`
  - ✅ ユーザー指定の正規URL: `https://midnight480.com/`

#### Cloudflareドメインの確認
- **URL**: `https://astro-notion-blog-cq9.pages.dev/`
- **期待される状態**:
  - ❌ インデックス未登録（リダイレクトのため）
  - または
  - ✅ Canonical URL: `https://midnight480.com/`（リダイレクト前にクロールされた場合）

### 2. カバレッジレポート

#### 有効なページ
- **midnight480.com**: インデックス数の増加を確認
- **pages.dev**: インデックス数の減少を確認

#### 除外されたページ
- **pages.dev**: 「リダイレクトエラー」または「重複、ユーザーにより正規ページとして選択されていません」の増加

### 3. サイトマップ

#### カスタムドメインのサイトマップ送信
1. 「サイトマップ」セクションに移動
2. `https://midnight480.com/sitemap.xml` を送信
3. 送信済みページ数とインデックス登録済みページ数を監視

#### Cloudflareドメインのサイトマップ
- 送信しない（リダイレクトされるため不要）

## 重複コンテンツの監視

### 1. 重複するメタ説明

**場所**: 「拡張」→「HTMLの改善」

**監視項目**:
- 重複するメタ説明の数が減少しているか
- midnight480.com のページが正規版として認識されているか

### 2. 重複するタイトルタグ

**監視項目**:
- 同一タイトルのページ数の減少
- pages.dev ドメインのページが除外されているか

### 3. 正規化

**場所**: 「設定」→「正規化」

**確認項目**:
- Google が選択した正規URL が midnight480.com になっているか
- ユーザー指定の正規URL が適切に設定されているか

## パフォーマンス監視

### 1. 検索パフォーマンス

#### 監視する指標
- **クリック数**: カスタムドメインでの増加
- **表示回数**: 検索結果での露出増加
- **平均CTR**: クリック率の改善
- **平均掲載順位**: 検索順位の向上

#### フィルター設定
- **ページ**: `midnight480.com` でフィルター
- **期間**: 実装前後の比較（3ヶ月程度）

### 2. クロール統計情報

#### カスタムドメイン
- **1日あたりのクロールされたページ数**: 増加傾向
- **1日あたりにダウンロードされたキロバイト数**: 安定
- **ページのダウンロード時間**: 改善

#### Cloudflareドメイン
- **クロール頻度**: 減少傾向（期待される動作）
- **リダイレクト応答**: 301リダイレクトの確認

## アラート設定

### 1. 重要な問題のアラート

Google Search Console の「メッセージ」機能で以下を監視：

- **インデックス カバレッジの問題**
- **手動による対策**
- **セキュリティの問題**
- **構造化データの問題**

### 2. 週次レポートの確認

毎週確認すべき項目：

1. **新しいインデックス登録の問題**
2. **クロールエラーの増加**
3. **検索パフォーマンスの変化**
4. **重複コンテンツの状況**

## 効果測定のタイムライン

### 実装直後（1-2週間）

- [ ] リダイレクトの動作確認
- [ ] Canonical URLの設定確認
- [ ] Robots.txtの配信確認
- [ ] 初期クロール状況の確認

### 短期（1ヶ月）

- [ ] インデックス状況の変化
- [ ] 重複コンテンツの減少
- [ ] クロール頻度の変化
- [ ] 検索パフォーマンスの初期変化

### 中期（3ヶ月）

- [ ] 検索順位の改善
- [ ] クリック率の向上
- [ ] インデックス数の安定化
- [ ] 重複コンテンツの完全解決

### 長期（6ヶ月以上）

- [ ] 検索トラフィックの増加
- [ ] ブランド検索の向上
- [ ] 全体的なSEOパフォーマンスの改善

## レポート作成

### 月次レポートテンプレート

```markdown
# SEO改善効果レポート - [年月]

## 概要
- 実装日: [日付]
- 監視期間: [期間]
- 主要な変化: [概要]

## インデックス状況
- midnight480.com: [ページ数] (+/- [変化])
- pages.dev: [ページ数] (+/- [変化])

## 検索パフォーマンス
- クリック数: [数値] (+/- [変化率])
- 表示回数: [数値] (+/- [変化率])
- 平均CTR: [数値] (+/- [変化率])
- 平均掲載順位: [数値] (+/- [変化])

## 重複コンテンツ
- 重複メタ説明: [数値] (+/- [変化])
- 重複タイトル: [数値] (+/- [変化])

## 課題と対策
- [課題1]: [対策]
- [課題2]: [対策]

## 次月の目標
- [目標1]
- [目標2]
```

## トラブルシューティング

### よくある問題

#### 1. インデックス登録が進まない

**症状**: カスタムドメインのページがインデックスされない

**確認項目**:
- [ ] Robots.txtでクロールが許可されているか
- [ ] Canonical URLが正しく設定されているか
- [ ] サイトマップが送信されているか
- [ ] ページの品質に問題がないか

**対策**:
1. URL検査ツールで「インデックス登録をリクエスト」
2. サイトマップの再送信
3. 内部リンクの強化

#### 2. 重複コンテンツが解決されない

**症状**: 両ドメインのページがインデックスされ続ける

**確認項目**:
- [ ] リダイレクトが正常に動作しているか
- [ ] Canonical URLが両ドメインで同じ値を指しているか
- [ ] Robots.txtでCloudflareドメインが制限されているか

**対策**:
1. リダイレクト設定の確認
2. Canonical URL設定の見直し
3. 手動でのURL削除リクエスト

#### 3. 検索パフォーマンスが改善されない

**症状**: 実装後も検索順位やクリック率が向上しない

**確認項目**:
- [ ] 十分な時間が経過しているか（3-6ヶ月）
- [ ] 他のSEO要因に問題がないか
- [ ] 競合サイトの状況変化

**対策**:
1. より長期的な監視
2. コンテンツ品質の向上
3. 技術的SEOの他の側面の改善

## 自動化ツール

### Google Search Console API

定期的なデータ取得の自動化：

```javascript
// 例: 検索パフォーマンスデータの取得
const searchConsoleData = await gapi.client.searchconsole.searchanalytics.query({
  siteUrl: 'https://midnight480.com',
  resource: {
    startDate: '2025-01-01',
    endDate: '2025-01-31',
    dimensions: ['page'],
    rowLimit: 1000
  }
});
```

### 監視スクリプト

```bash
#!/bin/bash
# 日次監視スクリプト例

# リダイレクト確認
curl -I https://astro-notion-blog-cq9.pages.dev/ | grep "301"

# Canonical URL確認
curl -s https://midnight480.com/ | grep -o 'rel="canonical"[^>]*'

# Robots.txt確認
curl -s https://midnight480.com/robots.txt | grep "Allow: /"
```

---

**最終更新**: 2025年2月2日  
**バージョン**: 1.0.0